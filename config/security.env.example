# =============================================================================
# CONFIGURAZIONE SICUREZZA DOCS
# Copia questo file in .env e configura i valori per il tuo ambiente
# =============================================================================

# === CLAMAV ANTIVIRUS ===
# Host del servizio ClamAV (default: localhost)
CLAMAV_HOST=localhost

# Porta del servizio ClamAV (default: 3310)
CLAMAV_PORT=3310

# Modalità strict per upload: se True, blocca upload anche per errori di scansione
# Se False, permette upload anche se la scansione fallisce (default: False)
STRICT_UPLOAD_SECURITY=False

# === WATERMARK PDF ===
# Abilita/disabilita watermark automatico sui PDF (default: True)
WATERMARK_ENABLED=True

# Template per il testo del watermark
# Variabili disponibili: {username}, {full_name}, {email}, {timestamp}, {date}, {time}, {ip}, {document_title}, {document_id}, {company}, {department}
WATERMARK_TEXT_TEMPLATE=User: {username} | {timestamp} | IP: {ip}

# === ALERT COMPORTAMENTI ANOMALI ===
# Soglia per alert burst download: numero massimo di download in un periodo (default: 10)
ALERT_BURST_THRESHOLD=10

# Finestra temporale per burst download in minuti (default: 5)
ALERT_BURST_WINDOW_MIN=5

# === CONFIGURAZIONE EMAIL PER ALERT ===
# Configurazione già esistente in .env principale
# MAIL_SERVER=smtp.gmail.com
# MAIL_PORT=587
# MAIL_USE_TLS=True
# MAIL_USERNAME=your-email@gmail.com
# MAIL_PASSWORD=your-app-password
# MAIL_DEFAULT_SENDER=security@mercurysurgelati.org

# === CONFIGURAZIONE DATABASE ===
# Le tabelle di sicurezza verranno create automaticamente con le migrazioni
# Assicurati di eseguire: flask db upgrade

# === INSTALLAZIONE DIPENDENZE ===
# Per il funzionamento completo, installa:
# pip install pyclamd PyPDF2 reportlab pikepdf

# === SERVIZI RICHIESTI ===
# ClamAV daemon deve essere in esecuzione:
# - Ubuntu/Debian: sudo apt install clamav clamav-daemon
# - CentOS/RHEL: sudo yum install clamav clamav-scanner-systemd
# - Docker: docker run -d --name clamav -p 3310:3310 mkodockx/docker-clamav

# === NOTE SICUREZZA ===
# 1. ClamAV: Assicurati che le signature siano aggiornate (freshclam)
# 2. Watermark: I file PDF verranno modificati permanentemente
# 3. Alert: Gli amministratori riceveranno email per alert HIGH severity
# 4. Hash: I file vengono verificati tramite SHA-256 per integrità
# 5. Audit: Tutti gli eventi di sicurezza vengono loggati

# === ESEMPI CONFIGURAZIONE ===
# Ambiente di sviluppo (permissivo):
# STRICT_UPLOAD_SECURITY=False
# ALERT_BURST_THRESHOLD=50
# WATERMARK_ENABLED=False

# Ambiente di produzione (rigoroso):
# STRICT_UPLOAD_SECURITY=True
# ALERT_BURST_THRESHOLD=5
# WATERMARK_ENABLED=True
